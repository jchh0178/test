<?xml version="1.0" encoding="UTF-8"?>

<!--
	https://mybatis.org/mybatis-3/getting-started.html 
	src/main/resources/mapper폴더/BoardMapper.xml파일 
	
-->
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="com.itwillbs.mapper.BoardMapper">

	<select id="getMaxNum" resultType="java.lang.Integer">
		select max(num) from board
	</select>


  <insert id="insertBoard">
    insert into board(num, name, subject, content, rdate, readcount, file) 
    values (#{num}, #{name}, #{subject}, #{content}, #{rdate}, #{readcount}, #{file})
  </insert>
  
  <select id="listBoard" resultType="com.itwillbs.domain.BoardDTO">
 	 select * from board
 	 <!-- 		검색어 %검색어% 문자열 합치는 mysql 함수 CONCAT() 
			마이바티스 제공 : 동적 쿼리 Dynamic SQL-->
		<if test="search != null">
		where subject like CONCAT('%', #{search}, '%')
		</if>
 	 
 	 order by num desc
 	 limit #{startRow}, #{pageSize}
  </select>
  
  <select id="contentBoard" resultType="com.itwillbs.domain.BoardDTO">
  	select * from board
  	where num = #{num}
  </select>
 
 <update id="updateReadcount">
 	update board set readcount = (readcount + 1) 
 	where num = #{num}
 </update>
 
 <update id="updateBoard">
 	update board 
 	set subject = #{subject}, content = #{content}
 	where num = #{num} 
 </update>
 
 <delete id="deleteBoard">
 	delete from board
 	where num = #{num} 
 </delete>
 
  <select id="countBoard" resultType="java.lang.Integer">
        select count(*) from board
        <!-- 		검색어 %검색어% 문자열 합치는 mysql 함수 CONCAT() 
			마이바티스 제공 : 동적 쿼리 Dynamic SQL-->
		<if test="search != null">
		where subject like CONCAT('%', #{search}, '%')
		</if>
        
  </select>

 
 
 
  
</mapper>